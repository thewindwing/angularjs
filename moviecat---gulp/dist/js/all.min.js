angular.module("movieCat",["ui.router","route","commonModule","in_theatersModule","coming_soonModule","searchModule"]).controller("navBarCtrl",["$scope","$location",function(e,o){e.search=function(){o.path("/search/1/"+e.keyword),e.keyword=""}}]),angular.module("route",[]).config(["$stateProvider","$urlRouterProvider","$sceDelegateProvider",function(e,o,t){e.state({url:"/in_theaters/:page",templateUrl:"./views/in_theaters/in_theaters.html",name:"in_theaters",controller:"in_theatersCtrl"}).state({url:"/coming_soon/:page",templateUrl:"./views/coming_soon/coming_soon.html",name:"coming_soon",controller:"coming_soonCtrl"}).state({url:"/search/:page/:keyword",templateUrl:"./views/search/search.html",name:"search",controller:"searchCtrl"}),o.otherwise("/in_theaters/1")}]),angular.module("commonModule",[]).service("myService",[function(){this.myJsonp=function(e,o,t){var n="myJsonp_"+Math.random().toString().replace(".","");window[n]=t;var a="";for(var r in o)a+=r+"="+o[r]+"&";var c=document.createElement("script");c.src=e+"?"+a+"callback="+n,c.onload=function(){document.body.removeChild(c)},document.body.appendChild(c)}}]),angular.module("coming_soonModule",[]).controller("coming_soonCtrl",["$scope","$http","myService","$stateParams","$location",function(e,o,t,n,a){var r=n.page,c=10*(r-1),l=0;t.myJsonp("https://api.douban.com/v2/movie/coming_soon",{count:10,start:c},function(o){console.log(o),e.result=o,l=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"next"==e?++r>l&&(r=l):"prev"==e&&--r<1&&(r=1),a.path("/coming_soon/"+r)}}]),angular.module("in_theatersModule",[]).controller("in_theatersCtrl",["$scope","$http","myService","$stateParams","$location",function(e,o,t,n,a){var r=n.page,c=10*(r-1),l=0;t.myJsonp("https://api.douban.com/v2/movie/in_theaters",{count:10,start:c},function(o){console.log(o),e.result=o,l=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"next"==e?++r>l&&(r=l):"prev"==e&&--r<1&&(r=1),a.path("/in_theaters/"+r)}}]),angular.module("searchModule",[]).controller("searchCtrl",["$scope","$stateParams","myService","$location",function(e,o,t,n){var a=o.keyword,r=o.page,c=10*(r-1),l=0;t.myJsonp("https://api.douban.com/v2/movie/search",{q:a,count:10,start:c},function(o){e.result=o,l=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"next"==e?++r>l&&(r=l):"prev"==e&&--r<1&&(r=1),n.path("/search/"+r+"/"+a)}}]);